document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".nav__toggle"),t=document.querySelector(".nav__mobile");e&&t&&(e.addEventListener("click",function(){t.classList.toggle("is-open");const n=t.classList.contains("is-open");e.setAttribute("aria-expanded",n)}),t.querySelectorAll("a").forEach(n=>{n.addEventListener("click",()=>{t.classList.remove("is-open"),e.setAttribute("aria-expanded","false")})})),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){const t=document.querySelector(this.getAttribute("href"));t&&(e.preventDefault(),t.scrollIntoView({behavior:"smooth",block:"start"}))})});const n=document.querySelectorAll(".scroll-reveal, .scroll-reveal-left, .scroll-reveal-right, .scroll-reveal-scale, .fade-in");if(n.length>0&&"IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("visible","is-visible"),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});n.forEach(t=>e.observe(t))}else n.forEach(e=>e.classList.add("visible","is-visible"));const r=document.querySelectorAll("[data-count]");if(r.length>0&&"IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const n=parseInt(t.target.dataset.count,10);((e,t,n=2e3)=>{const r=t/(n/16);let o=0;const s=()=>{if(o+=r,o<t)e.textContent=Math.floor(o),requestAnimationFrame(s);else{e.textContent=t;const n=e.dataset.suffix||"";e.textContent=t+n}};s()})(t.target,n),e.unobserve(t.target)}})},{threshold:.5});r.forEach(t=>e.observe(t))}const o=document.querySelector(".hero-animated");if(o){const e=document.createElement("div");e.className="protection-rings",e.setAttribute("aria-hidden","true");for(let t=0;t<5;t++){const t=document.createElement("div");t.className="protection-ring",e.appendChild(t)}o.appendChild(e)}document.querySelectorAll(".data-flow-container").forEach(e=>{for(let t=0;t<5;t++){const n=document.createElement("div");n.className="data-point",e.appendChild(n),setTimeout(()=>{n.classList.add("protected")},500*t+2500)}}),document.querySelectorAll(".btn, .btn--primary, .btn--secondary").forEach(e=>{e.classList.add("btn-animated")}),document.querySelectorAll(".feature-card, .product-card, .pricing-card, .use-case-card").forEach(e=>{e.classList.add("card-animated")});const s=document.getElementById("contactForm"),a=document.getElementById("formSuccess");function i(e,t){const n=e.querySelector(".form-error");n&&n.remove();const r=document.createElement("div");r.className="form-error",r.style.cssText="padding: 1rem; background: #fef2f2; color: #991b1b; border-radius: 0.5rem; text-align: center; margin-top: 1rem; animation: fadeInScale 0.3s ease-out;",r.innerHTML=`<strong>Error:</strong> ${t}`,e.appendChild(r),setTimeout(()=>{r.style.animation="fadeInScale 0.3s ease-out reverse",setTimeout(()=>r.remove(),300)},5e3)}s&&(s.querySelectorAll("input, textarea, select").forEach(e=>{e.classList.add("form-input-animated")}),s.addEventListener("submit",async function(e){e.preventDefault();const t=this.querySelector('button[type="submit"]'),n=t.innerHTML;t.innerHTML='<span class="loading-ring" style="width:20px;height:20px;border-width:2px;margin-right:8px;"></span> Sending...',t.disabled=!0;try{let e="";if("undefined"!=typeof grecaptcha)try{e=await grecaptcha.execute("6LcFEFosAAAAAH6zUMF5USUNKGGjr07y97nC5uDr",{action:"contact_form"})}catch(e){console.error("reCAPTCHA error:",e)}const r={name:this.querySelector("#name").value.trim(),email:this.querySelector("#email").value.trim(),institution:this.querySelector("#institution").value.trim(),interest:this.querySelector("#interest").value,message:this.querySelector("#message").value.trim(),recaptcha_token:e},o=await fetch("api/send-message.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await o.json();if(s.success)this.style.display="none",a&&(a.style.display="block",a.style.animation="fadeInScale 0.4s ease-out"),this.reset();else{i(this,s.errors?s.errors.join(", "):s.error||"Failed to send message"),t.innerHTML=n,t.disabled=!1}}catch(e){console.error("Form submission error:",e),i(this,"Network error. Please try again later."),t.innerHTML=n,t.disabled=!1}}));const c=window.location.pathname.split("/").pop()||"index.html";document.querySelectorAll(".nav__link").forEach(e=>{const t=e.getAttribute("href");(t===c||""===c&&"index.html"===t)&&e.classList.add("nav__link--active")});const l=document.querySelector(".header");if(l){let e=0;window.addEventListener("scroll",()=>{const t=window.pageYOffset;t>100?l.classList.add("header--scrolled"):l.classList.remove("header--scrolled"),e=t},{passive:!0})}document.querySelectorAll(".feature-card__icon, .product-card__icon").forEach(e=>{e.classList.add("icon-animated")});const d=window.matchMedia("(prefers-reduced-motion: reduce)");d.matches&&document.documentElement.classList.add("reduced-motion"),d.addEventListener("change",e=>{e.matches?document.documentElement.classList.add("reduced-motion"):document.documentElement.classList.remove("reduced-motion")}),document.querySelectorAll("[data-tooltip]").forEach(e=>{e.addEventListener("mouseenter",function(){const e=document.createElement("div");e.className="tooltip",e.textContent=this.dataset.tooltip,e.style.cssText="\n        position: absolute;\n        background: #134e4a;\n        color: white;\n        padding: 6px 12px;\n        border-radius: 6px;\n        font-size: 0.875rem;\n        white-space: nowrap;\n        z-index: 1000;\n        animation: fadeInScale 0.2s ease-out;\n      ";const t=this.getBoundingClientRect();e.style.top=`${t.top-40+window.scrollY}px`,e.style.left=`${t.left+t.width/2}px`,e.style.transform="translateX(-50%)",document.body.appendChild(e),this._tooltip=e}),e.addEventListener("mouseleave",function(){this._tooltip&&(this._tooltip.remove(),this._tooltip=null)})})}),function(){var e=window.location.pathname,t=e.substring(e.lastIndexOf("/")+1)||"index.html";document.querySelectorAll("nav a[href], .nav__link").forEach(function(e){var n=e.getAttribute("href");n!==t&&("/"!==n||"index.html"!==t&&""!==t)||e.setAttribute("aria-current","page")})}(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js");